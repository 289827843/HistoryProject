<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sxun.server.platform.service.cms.dao.CmsArticleMapper">
  <resultMap id="BaseResultMap" type="com.sxun.server.platform.service.cms.model.CmsArticle">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="article_id" jdbcType="INTEGER" property="articleId" />
    <result column="title" jdbcType="VARCHAR" property="title" />
    <result column="source" jdbcType="VARCHAR" property="source" />
    <result column="author" jdbcType="VARCHAR" property="author" />
    <result column="status" jdbcType="INTEGER" property="status" />
    <result column="article_type" jdbcType="INTEGER" property="articleType" />
    <result column="own_user_id" jdbcType="INTEGER" property="ownUserId" />
    <result column="audit_user_id" jdbcType="INTEGER" property="auditUserId" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="dir_id" jdbcType="INTEGER" property="dirId" />
    <result column="audit_memo" jdbcType="VARCHAR" property="auditMemo" />
  </resultMap>
  <select id="findArticles" resultType="Integer">
    select count(*) from
    cms_article where dir_id=#{dir_id}
  </select>
  <insert id="insertArticle" parameterType="com.sxun.server.platform.service.cms.model.CmsArticle">
    insert into cms_article(
    `article_id,
    title,
    source,
    author,
    status,
    article_type,
    own_user_id,
    audit_user_id,
    create_time,
    modify_time,
    dir_id,
    audit_memo)values(
    NULL,
    #{title},
    #{source},
    #{author},
    0,
    #{article_type}
    #{own_user_id},
    #{audit_user_id},
    NOW(),
    #{modify_time},
    #{dir_id},
    #{audit_memo}
    );
  </insert>
  <select id="findArticleid" resultType="Integer">
    <if test="dir_id != null and dir_id != ''">
      select article_id from cms_article where dir_id=#{dir_id}
    </if>
  </select>
  <update id="updateAriticle" parameterType="com.sxun.server.platform.service.cms.model.CmsArticle">
    update cms_article
    set title=#{ title},
    source=#{source},
    author=#{author},
    article_type=#{article_type},
    status=#{status}
    dir_id=#{dir_id}
    where article_id=#{article_id}

  </update>
  <select id="getCounts" resultType="Integer">
    select count(*)
    from  cms_article
    where article_id=#{article_id}
  </select>
  <update id="sumbitAriticle" parameterType="com.sxun.server.platform.service.cms.model.CmsArticle">
    update cms_article
    set audit_user_id=#{ audit_user_id},
    audit_memo=#{audit_memo},
    status=#{status}
    where article_id=#{article_id}

  </update>
  <select id="getStatus" resultType="Integer">
    select status
    from  cms_article
    where article_id=#{article_id}
  </select>
  <select id="findArticle" resultMap="com.sxun.server.platform.service.cms.model.CmsArticle">
    select *
    from  cms_article
    where article_id=#{article_id}
  </select>
  <update id="updateStatus" parameterType="com.sxun.server.platform.service.cms.model.CmsArticle">
    update cms_article
    set
    status=#{status}
    where article_id=#{article_id}

  </update>
  <select id="listAriticle" resultMap="com.sxun.server.platform.service.cms.model.CmsArticle">
    select *
    from  cms_article
    <where>
    <if test="dir_id != null ">
      and dir_id=#{dir_id}
    </if>
    <if test="title != null ">
      and title =#{title}
    </if>
    <if test="source != null  ">
      and source=#{source}
    </if>
    <if test="author!= null ">
      and author =#{author}
    </if>
    <if test="is_display!= null">
      and article_type =#{article_type}
    </if>
    </where>
    limit #{startIndex},#{page_size};
  </select>
  <select id="getAriticleCounts" resultType="Integer">
    select count(*)
    from  cms_article
    <where>
      <if test="dir_id != null ">
        and dir_id=#{dir_id}
      </if>
      <if test="title != null ">
        and title =#{title}
      </if>
      <if test="source != null  ">
        and source=#{source}
      </if>
      <if test="author!= null ">
        and author =#{author}
      </if>
      <if test="is_display!= null">
        and article_type =#{article_type}
      </if>
    </where>
  </select>

</mapper>